<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self'; style-src 'self'; img-src 'self' data:"
    />
    <meta name="theme-color" content="#0f172a" />
    <title>Cloudcook PSADT Helper</title>
    <link rel="icon" type="image/svg+xml" href="assets/app-icon.svg" />
    <link rel="manifest" href="manifest.json" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <header class="site-header" data-sticky>
      <div class="max-width header-bar">
        <a class="site-brand" href="#intro">
          <span class="site-logo-wrap">
            <img
              class="site-logo"
              src="assets/cloudcook-logo.png"
              alt="Cloudcook"
              data-hide-on-error
            />
          </span>
          <span class="brand-text">
            <span class="brand-title">Cloudcook PSADT Helper</span>
            <span class="brand-tagline">Intuitive command crafting for PSADT</span>
          </span>
        </a>
        <div class="header-actions">
          <div class="theme-switcher" role="group" aria-label="Theme">
            <svg class="icon" aria-hidden="true"><use href="#ic-theme"></use></svg>
            <label for="header-color-mode" class="theme-label">Theme</label>
            <select id="header-color-mode" class="theme-select">
              <option value="light">Light</option>
              <option value="dark">Dark</option>
            </select>
          </div>
          <button
            class="menu-toggle"
            type="button"
            aria-expanded="false"
            aria-controls="primary-nav"
            data-nav-toggle
          >
            <span class="menu-icon" aria-hidden="true">
              <span></span>
              <span></span>
              <span></span>
            </span>
            <span class="menu-label">Menu</span>
          </button>
        </div>
        <div class="site-menu" data-nav-menu>
          <nav class="primary-nav" id="primary-nav" aria-label="Primary navigation">
            <a class="nav-link" href="#intro">Overview</a>
            <a class="nav-link" href="#scenario-search">Scenarios</a>
            <a class="nav-link" href="#builder">Command builder</a>
            <a class="nav-link" href="#variable-panel">Variable helper</a>
            <a class="nav-link" href="docs/reference/v4-function-mapping/">
              <svg class="icon" aria-hidden="true"><use href="#ic-files"></use></svg>
              <span>Function mapping</span>
            </a>
          </nav>
          <div class="menu-preferences">
            <label for="telemetry-toggle" class="preference">
              <input type="checkbox" id="telemetry-toggle" />
              <span class="preference-label">Enable telemetry</span>
            </label>
            <label for="cache-toggle" class="preference">
              <input type="checkbox" id="cache-toggle" />
              <span class="preference-label">Enable offline cache</span>
            </label>
          </div>
        </div>
      </div>
    </header>

    <!-- SVG Icon Sprite -->
    <svg xmlns="http://www.w3.org/2000/svg" style="display: none">
      <symbol id="ic-copy" viewBox="0 0 24 24">
        <path
          fill="currentColor"
          d="M16 1H4a2 2 0 0 0-2 2v12h2V3h12V1Zm3 4H8a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2Zm0 16H8V7h11v14Z"
        />
      </symbol>
      <symbol id="ic-theme" viewBox="0 0 24 24">
        <path fill="currentColor" d="M12 3a9 9 0 1 0 9 9a7 7 0 0 1-9-9Z" />
      </symbol>
      <symbol id="ic-files" viewBox="0 0 24 24">
        <path
          fill="currentColor"
          d="M14 2H6a2 2 0 0 0-2 2v14h2V4h8V2Zm4 4h-8a2 2 0 0 0-2 2v14h10a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2Zm0 14H8V8h10v12Z"
        />
      </symbol>
      <symbol id="ic-play" viewBox="0 0 24 24">
        <path fill="currentColor" d="M8 5v14l11-7L8 5Z" />
      </symbol>
      <symbol id="ic-download" viewBox="0 0 24 24">
        <path
          fill="currentColor"
          d="M5 20h14v-2H5v2Zm7-18l-5 5h3v6h4V7h3l-5-5Z"
        />
      </symbol>
      <symbol id="ic-edit" viewBox="0 0 24 24">
        <path
          fill="currentColor"
          d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25ZM20.71 7.04a1.003 1.003 0 0 0 0-1.42l-2.34-2.34a1.003 1.003 0 0 0-1.42 0l-1.83 1.83 3.75 3.75 1.84-1.82Z"
        />
      </symbol>
      <symbol id="ic-star" viewBox="0 0 24 24">
        <path
          fill="currentColor"
          d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.62L12 2 9.19 8.62 2 9.24l5.46 4.73L5.82 21 12 17.27Z"
        />
      </symbol>
      <symbol id="ic-star-outline" viewBox="0 0 24 24">
        <path
          fill="currentColor"
          d="M22 9.24l-7.19-.62L12 2 9.19 8.62 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.64-7.03L22 9.24Zm-10 6.11-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.88 4.38.38-3.32 2.88 1 4.28L12 15.35Z"
        />
      </symbol>
    </svg>

    <main id="main-content" tabindex="-1">
      <section id="intro" class="hero-section">
        <div class="max-width hero">
          <div class="hero-content">
            <p class="hero-kicker">PSAppDeployToolkit v4 ready</p>
            <h2 class="hero-title">Build and ship dependable deployments with clarity</h2>
            <p class="hero-summary">
              The Cloudcook PSADT Helper blends curated scenarios, smart command
              composition, and variable insights into a single focused workspace.
            </p>
            <div class="hero-actions">
              <a href="#scenario-search" class="btn btn-primary">Explore scenarios</a>
              <a href="#builder" class="btn" data-open-builder>Open command builder</a>
              <a href="#variable-panel" class="btn btn-ghost">Browse variables</a>
            </div>
            <dl class="hero-metrics" aria-label="Platform highlights">
              <div>
                <dt>Scenario library</dt>
                <dd>60+ ready-to-run blueprints</dd>
              </div>
              <div>
                <dt>Builder output</dt>
                <dd>Copy, share, or export instantly</dd>
              </div>
              <div>
                <dt>Variable helper</dt>
                <dd>Every runtime token explained</dd>
              </div>
            </dl>
          </div>
          <div class="hero-visual" aria-hidden="true">
            <div class="hero-board">
              <div class="hero-card">
                <span class="hero-card-label">Live preview</span>
                <pre class="hero-card-output">
Deploy-Application -Action Install
Show-InstallationWelcome -CloseApps 'Teams, Outlook'
Invoke-PSADTScenario 'Silently install vendor updates'
                </pre>
              </div>
              <div class="hero-card secondary">
                <span class="hero-card-label">Why teams use it</span>
                <ul>
                  <li>Opinionated guidance that keeps packaging consistent.</li>
                  <li>One-click exports for release pipelines.</li>
                  <li>Dark mode and offline cache for field work.</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section class="dashboard" aria-label="PSADT workspace">
        <div class="max-width dashboard-grid">
          <aside class="dashboard-panel scenario-panel" aria-label="Scenarios">
            <header class="panel-heading">
              <h3>Scenario navigator</h3>
              <p>Search, favorite, and launch curated deployment flows.</p>
            </header>
            <label class="field" for="scenario-search">
              <span class="field-label">Search scenarios</span>
              <input
                type="search"
                id="scenario-search"
                placeholder="Filter by name or goal"
                aria-label="Search scenarios"
              />
            </label>
            <div class="scenario-list" id="scenario-list"></div>
          </aside>

          <section class="dashboard-main">
            <div id="scenario-details" class="card hidden"></div>
            <div id="empty" class="empty-state">
              <div class="empty-content">
                <h3>Select a scenario to begin</h3>
                <p>Choose from the library on the left to load guidance and a ready-made command.</p>
              </div>
            </div>
            <div id="output" class="card hidden">
              <div class="output-header">
                <div>
                  <span class="output-title">Generated command</span>
                  <p class="output-caption">Share-ready PSADT syntax based on your selections.</p>
                </div>
                <div class="output-actions">
                  <button id="add-btn" class="btn btn-ghost">
                    <svg class="icon" aria-hidden="true"><use href="#ic-play" /></svg>
                    <span>Add</span>
                  </button>
                  <button id="copy-btn" class="btn">
                    <svg class="icon" aria-hidden="true"><use href="#ic-copy" /></svg>
                    <span>Copy</span>
                  </button>
                  <button id="share-btn" class="btn">
                    <svg class="icon" aria-hidden="true"><use href="#ic-copy" /></svg>
                    <span>Permalink</span>
                  </button>
                  <button id="export-btn" class="btn">
                    <svg class="icon" aria-hidden="true"><use href="#ic-download" /></svg>
                    <span>Export</span>
                  </button>
                  <button id="import-btn" class="btn">
                    <svg class="icon" aria-hidden="true"><use href="#ic-files" /></svg>
                    <span>Import</span>
                  </button>
                  <input type="file" id="import-file" accept="application/json" hidden />
                  <button id="reset-btn" class="btn btn-ghost">
                    <span>Reset</span>
                  </button>
                </div>
              </div>
              <pre id="command" class="code" aria-live="polite"></pre>
            </div>
            <div id="script" class="card hidden">
              <div class="output-header">
                <div>
                  <span class="output-title">Script</span>
                  <p class="output-caption">Review the assembled deployment script.</p>
                </div>
                <div class="output-actions">
                  <button id="share-script-btn" class="btn">
                    <svg class="icon" aria-hidden="true"><use href="#ic-copy" /></svg>
                    <span>Copy Link</span>
                  </button>
                  <button id="download-script-btn" class="btn">
                    <svg class="icon" aria-hidden="true"><use href="#ic-download" /></svg>
                    <span>Download</span>
                  </button>
                  <button id="copy-script-btn" class="btn">
                    <svg class="icon" aria-hidden="true"><use href="#ic-copy" /></svg>
                    <span>Copy Script</span>
                  </button>
                </div>
              </div>
              <div id="script-commands" aria-live="polite"></div>
            </div>
            <details id="builder" class="card panel" data-panel>
              <summary class="panel-summary">
                <div>
                  <span class="panel-title">Command builder</span>
                  <p class="panel-caption">Mix and match PSADT functions, parameters, and notes.</p>
                </div>
                <span class="panel-toggle" aria-hidden="true"></span>
              </summary>
              <div class="panel-body" data-panel-body>
                <div class="builder-grid">
                  <div class="builder-library">
                    <label class="visually-hidden" for="command-search">Search commands</label>
                    <input
                      type="search"
                      id="command-search"
                      class="builder-search"
                      placeholder="Search commands"
                      aria-label="Search commands"
                    />
                    <div id="command-boxes" class="builder-boxes" aria-label="PSADT commands"></div>
                  </div>
                  <div id="command-detail" class="builder-detail empty" aria-live="polite">
                    <p>Select a command to view parameters.</p>
                  </div>
                </div>
                <div
                  id="editor-area"
                  class="builder-editor"
                  contenteditable="true"
                  aria-label="Custom script editor"
                ></div>
              </div>
            </details>
          </section>

          <aside class="dashboard-panel utility-panel" aria-label="Variable helper">
            <details class="card panel" id="variable-panel" data-panel>
              <summary class="panel-summary">
                <div>
                  <span class="panel-title">Variable helper</span>
                  <p class="panel-caption">Look up runtime variables with descriptions and usage.</p>
                </div>
                <span class="panel-toggle" aria-hidden="true"></span>
              </summary>
              <div class="panel-body" data-panel-body>
                <div class="variable-intro">
                  <p>
                    Based on the
                    <a
                      href="https://psappdeploytoolkit.com/docs/reference/variables"
                      target="_blank"
                      rel="noreferrer"
                      >PSADT 4.1 variable reference</a
                    >.
                    <span id="variable-count" class="variable-count" aria-live="polite"></span>
                  </p>
                </div>
                <label class="field" for="variable-search">
                  <span class="field-label">Search variables</span>
                  <input
                    type="search"
                    id="variable-search"
                    class="variable-search-input"
                    placeholder="Search variables"
                    aria-label="Search variables"
                  />
                </label>
                <div class="variable-layout">
                  <div id="variable-results" class="variable-results"></div>
                  <div id="variable-detail" class="variable-detail empty" aria-live="polite">
                    <p class="variable-empty">Select a variable to see details.</p>
                  </div>
                </div>
              </div>
            </details>
          </aside>
        </div>
      </section>
    </main>

    <footer class="site-footer">
      <div class="max-width footer-content">
        <span>Cloudcook PSADT Helper</span>
        <span aria-hidden="true">·</span>
        <a href="https://psappdeploytoolkit.com/" target="_blank" rel="noreferrer">PSADT Docs</a>
        <span aria-hidden="true">·</span>
        <a
          href="https://github.com/PSAppDeployToolkit/PSAppDeployToolkit"
          target="_blank"
          rel="noreferrer"
          >GitHub</a
        >
      </div>
    </footer>

    <div id="variable-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="variable-modal-title">
      <div class="modal-overlay" data-modal-dismiss></div>
      <div class="modal-container" role="document">
        <button
          type="button"
          class="modal-close"
          id="variable-modal-close"
          data-modal-dismiss
          aria-label="Close variable details"
        >
          <span aria-hidden="true">&times;</span>
        </button>
        <div id="variable-modal-body" class="modal-body"></div>
      </div>
    </div>

    <script src="src/js/telemetry.js"></script>
    <script src="src/js/legacy-mapping.js"></script>
    <script src="src/js/commands.js"></script>
    <script src="src/js/state.js"></script>
    <script src="src/js/favorites.js"></script>
    <script src="src/js/scenario-list.js"></script>
    <script src="src/js/variables.js"></script>
    <script src="src/js/sw-registration.js"></script>
    <script src="src/js/main.js"></script>
    <script src="src/js/editor.js"></script>
  </body>
</html>
